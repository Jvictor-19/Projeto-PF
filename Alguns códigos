const fs = require('fs')
const csv = require('csv-parser')

const lerCSV = (caminhoArquivo) => {
    return new Promise((resolve, reject) => {
        const resultados = []
        fs.createReadStream(caminhoArquivo)
            .pipe(csv())
            .on('data', (linha) => {
                resultados.push(linha)
            })
            .on('end', () => {
                resolve(resultados)
            })
            .on('error', (error) => {
                console.error('Erro ao ler o arquivo CSV:', error)
                reject(error);
            })
    })
}

lerCSV('athlete_events.csv')
    .then((dados) => {
        const encontrar1952Verao = helsinki(dados)
        console.log(`O País mais ao norte que já sediou uma Olímpiada foi ${encontrar1952Verao} em 1952 com sua sede em Helsinki`)
        const cidadeoriental = Tokyo(dados)
        console.log(`A primeira Olímpiada sediada na Ásia Oriental foi ${cidadeoriental} em 1968 com sua sede em Tokyo`)
    })
    .catch((error) => {
        console.error('Erro ao ler o arquivo CSV:', error)
    });

    const helsinki = (dados) => {
        return dados.reduce((Pais, registro) => {
            if (registro.Team === 'Finland') {
                return registro.Team;
            }
            return Pais;
        }, '');
    };

    const Tokyo = (dados) => {
        return dados.reduce((Pais1, registro) => {
            if (registro.Team === 'Japan') {
                return registro.Team;
            }
            return Pais1;
        }, '');
    };
    
